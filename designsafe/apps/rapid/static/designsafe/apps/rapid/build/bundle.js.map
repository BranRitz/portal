{"version":3,"sources":["webpack:///webpack/bootstrap 6b4f069571b6740cac4e","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/index.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/index.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/index.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/rapid-admin-users-ctrl.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/rapid-main-ctrl.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/event-listing-detailed.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/event-listing.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/rapid-admin-service.js","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/rapid-data-service.js","webpack:///external \"L\"","webpack:///./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/index.js"],"names":["mod","angular","module","controller","directive","service","RapidAdminUsersCtrl","UserService","RapidAdminService","list_admin_users","admin_users","resp","console","log","found_users","$scope","$compile","RapidDataService","show_sidebar","filter_options","active_rapid_event","streets","tileLayer","maxZoom","satellite","map","layers","scrollWheelZoom","setView","zoomControl","setPosition","get_event_types","then","events","forEach","d","marker","addLayer","rapid_event","on","$apply","ev","filtered_events","search","templateUrl","scope","event","$q","payload","username","user","action","$http","get","data","created_date","Date","event_date","f1","item","event_type","f2","search_text","title","substring","f3","start_date","f4","end_date","tmp","requires","push","config","$stateProvider","$uibTooltipProvider","$locationProvider","html5Mode","rewriteLinks","state","url","auth","resolve"],"mappings":"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","file":"./designsafe/apps/rapid/static/designsafe/apps/rapid/build/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6b4f069571b6740cac4e","import RapidMainCtrl from './rapid-main-ctrl';\nimport RapidAdminUsersCtrl from './rapid-admin-users-ctrl';\n\n\nlet mod = angular.module('ds.rapid.controllers', []);\n\nmod.controller('RapidMainCtrl', RapidMainCtrl);\nmod.controller('RapidAdminUsersCtrl', RapidAdminUsersCtrl);\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/index.js","import eventListing from './event-listing';\nimport eventListingDetailed from './event-listing-detailed';\n\nlet mod = angular.module('ds.rapid.directives', []);\n\nmod.directive('eventListing', eventListing);\nmod.directive('eventListingDetailed', eventListingDetailed);\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/index.js","import RapidDataService from './rapid-data-service';\nimport RapidAdminService from './rapid-admin-service';\n\nlet mod = angular.module('ds.rapid.services', []);\n\nmod.service('RapidDataService', RapidDataService);\nmod.service('RapidAdminService', RapidAdminService);\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/index.js","\nexport default class RapidAdminUsersCtrl {\n\n  constructor(UserService, RapidAdminService) {\n    'ngInject';\n    this.UserService = UserService;\n    this.RapidAdminService = RapidAdminService;\n    this.list_admin_users();\n\n  }\n\n  list_admin_users () {\n    this.UserService.search({q:'', role:'Rapid Admin'}).then( (resp)=>{\n      this.admin_users = resp;\n    });\n  }\n\n  search_users(q) {\n    if (q.length > 1) {\n      this.UserService.search({q:q}).then((resp)=>{\n        console.log(resp);\n        this.found_users = resp;\n      });\n    } else {\n      this.found_users = [];\n    }\n  }\n\n  make_admin(user) {\n    this.RapidAdminService.update_permissions(user, 'grant').then( (resp)=>{\n      this.list_admin_users();\n    });\n  }\n\n  revoke_admin(user) {\n    this.RapidAdminService.update_permissions(user, 'revoke').then( (resp)=>{\n      this.list_admin_users();\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/rapid-admin-users-ctrl.js","import L from 'L';\n\nexport default class RapidMainCtrl {\n  constructor ($scope, $compile, RapidDataService) {\n    'ngInject';\n    console.log(\"RapidMainCtrl\")\n    this.$scope = $scope;\n    this.$compile = $compile;\n    this.RapidDataService = RapidDataService;\n    this.show_sidebar = true;\n    this.filter_options = {};\n    this.active_rapid_event = null;\n\n    let streets = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n    });\n\n    let satellite = L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {\n      attribution: '&copy;',\n      maxZoom: 18,\n    });\n\n    let basemaps = {\n      'Street': streets,\n      'Satellite': satellite\n    };\n    this.map = L.map('map', {\n        layers: [streets, satellite],\n        scrollWheelZoom: true\n      }\n    ).setView([30.2672, -97.7431], 2);\n    this.map.zoomControl.setPosition('topright');\n\n    this.RapidDataService.get_event_types().then( (resp)=> {\n      this.event_types = resp;\n    });\n\n    this.RapidDataService.get_events().then( (resp)=>{\n      this.events = resp;\n      this.events.forEach((d)=> {\n        // let template = \"<div class=''>\" +\n        //   \"<h3> {{event.title}} </h3>\" +\n        //   \"<div ng-repeat='dataset in event.datasets'>\" +\n        //   \"<a href='{{dataset.href}}'> {{dataset.doi}} </a>\"+\n        //   \"</div>\";\n        // let linker = this.$compile(angular.element(template));\n        let marker = L.marker([d.location.lat, d.location.lon]);\n        // let newScope = this.$scope.$new();\n        // newScope.event = d;\n        // marker.bindPopup(linker(newScope)[0], {className : 'rapid-popup'});\n        this.map.addLayer(marker);\n        marker.rapid_event = d;\n        marker.on('click', (ev) => {\n          if (marker.rapid_event == this.active_rapid_event) {\n            this.active_rapid_event = null;\n          } else {\n            this.active_rapid_event = marker.rapid_event;\n            this.show_sidebar = true;\n          }\n          this.$scope.$apply();\n        });\n      });\n    });\n  }\n\n  select_event (ev) {\n    this.map.setView([ev.location.lat, ev.location.lon],8, {animate: true});\n    this.active_rapid_event = ev;\n  }\n\n  search () {\n    console.log(this.filter_options)\n    this.filtered_events = this.RapidDataService.search(this.events, this.filter_options);\n  }\n\n  clear_filters () {\n    this.filter_options = {};\n    this.search();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/controllers/rapid-main-ctrl.js","\nexport default function eventListingDetailed() {\n  return {\n    templateUrl: \"/static/designsafe/apps/rapid/html/event-listing-detailed.html\",\n    scope: {\n      event: '=event',\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/event-listing-detailed.js","\nexport default function eventListing() {\n  return {\n    templateUrl: \"/static/designsafe/apps/rapid/html/event-listing.html\",\n    scope: {\n      event: '=event',\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/directives/event-listing.js","export default class RapidAdminService {\n  constructor ($http, $q) {\n    'ngInject';\n    this.$http = $http;\n    this.$q = $q;\n  }\n\n  update_permissions (user, action) {\n    let payload = {\n      username: user.username,\n      action: action\n    };\n\n   return this.$http.post('/rapid/admin/users/permissions', payload).then( (resp)=>{\n     return resp.data;\n   });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/rapid-admin-service.js","export default class RapidDataService {\n  constructor ($http, $q) {\n    'ngInject';\n    this.$http = $http;\n    this.$q = $q;\n  }\n\n  get_events (opts) {\n    console.log(opts);\n    return this.$http.get('/rapid/events', opts).then( (resp) => {\n      resp.data.forEach( (d) =>{\n        d.created_date = new Date(d.created_date);\n        d.event_date = new Date(d.event_date);\n      });\n      return resp.data;\n    });\n  }\n\n  get_event_types () {\n    return this.$http.get('/rapid/event-types').then( (resp) => {\n      return resp.data;\n    });\n  }\n\n  search (events, filter_options) {\n    let tmp = _.filter(events, (item)=>{\n      let f1 = true;\n      if (filter_options.event_type) {\n        f1 = item.event_type == filter_options.event_type.name;\n      }\n      let f2 = true;\n      if (filter_options.search_text) {\n        f2 = item.title.substring(0, filter_options.search_text.length).toLowerCase() === filter_options.search_text.toLowerCase();\n      }\n      let f3 = true;\n      if (filter_options.start_date) {\n        f3 = item.event_date > filter_options.start_date;\n      }\n      let f4 = true;\n      if (filter_options.end_date) {\n        f4 = item.event_date < filter_options.end_date;\n      }\n      return f1 && f2 && f3 && f4;\n    });\n    return tmp;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/services/rapid-data-service.js","module.exports = L;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"L\"\n// module id = 9\n// module chunks = 0","import {mod as rapid_controllers} from './controllers';\nimport {mod as rapid_services} from './services';\nimport {mod as rapid_directives} from './directives';\n\nlet mod = angular.module('designsafe');\nmod.requires.push('ui.router','ds.rapid.controllers', 'ds.rapid.services', 'ds.rapid.directives', 'ngAnimate');\n\nfunction config($stateProvider, $uibTooltipProvider, $urlRouterProvider, $locationProvider) {\n  'ngInject';\n\n  $locationProvider.html5Mode({\n    enabled: true,\n    rewriteLinks: false\n  });\n\n  $stateProvider.state('rapid', {\n    url: '/',\n    templateUrl: '/static/designsafe/apps/rapid/html/index.html',\n    controller: 'RapidMainCtrl as vm',\n    resolve: {\n      auth: function () {\n        return true;\n      }\n    }\n  })\n  .state('rapid_admin', {\n    url: '/admin/users',\n    templateUrl: '/static/designsafe/apps/rapid/html/rapid-admin-users.html',\n    controller: 'RapidAdminUsersCtrl as vm',\n    resolve: {\n      auth: function () {\n        return true;\n      }\n    }\n  });\n\n  //config popups etc\n  $uibTooltipProvider.options({popupDelay:1000});\n\n}\n\nmod.config(config);\n\n\n\nexport default mod;\n\n\n\n// WEBPACK FOOTER //\n// ./designsafe/apps/rapid/static/designsafe/apps/rapid/scripts/index.js"],"sourceRoot":""}